<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<head>
    <link href="favicon.ico" rel="shortcut icon" type="image/x-icon" /> 
    <link href="favicon.ico" rel="icon" type="image/x-icon" /> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>KUDOS Sketchroom</title> 
    <link href="css/bee-xforms.css" rel="stylesheet" type="text/css" />
    <link href="css/kudos-sketchroom.css" rel="stylesheet" type="text/css" />
    <link href="css/jquery-ui.min.css" rel="stylesheet"/>
    
    <script src="js/kudos-sketchroom.js"></script>
    <script src="js/bee-xforms.js"></script>
    <!--script src="js/jquery.js"></script>
    <script src="js/jquery-ui-1.8.9.min.js"></script-->
    
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/jquery-ui-1.9.0.custom.min.js"></script>
    
    
    <script src="js/jquery.contextmenu.js"></script>
    <style>
		.logo {
			background:#000 url(img/logo_sketchroom.png) no-repeat 35px center ;
			margin-bottom:10px;
			text-align:right;
			padding:15px;
		}
		#toolbox, #pupilsToolbox {
			border:1px solid #bbb; 
			padding:5px;
			text-align:center;
		}
	
    </style>
</head>
<body>

	<div class="logo">
    	<button onclick="loadSample('data/room-definition1.xml')">Room1</button>
    	<button onclick="loadSample('data/room-definition2.xml')">Room2</button>
        <button onclick="loadSample()">Blank</button>
	    <button onclick="toogleEditorMode()">Readonly Mode</button>
    </div>
    
	<div style="padding-left:45px; padding-top:40px;">
        <div id="navbar" style="margin-top:-45px; position:absolute">
        	<but class="icon icon-save" title="Сохранить"  onclick="DV.toolDeploy();"></but>
            <but id="snapBut" class="icon icon-snap" title="Прилипать" onclick="DV.toolSnapToGrid();"></but><but class="icon icon-settings" onclick="DV.toolSettings();"  title="Настройки"></but>
        </div>
        
        <div id="toolbox" style="float:left; margin-left:-45px;">
        
        </div>
 
		<div id="notepad">
        
        </div>
        
        <div id="pupilsToolbox" class="dv-toolbox-buttons" style="margin-top:7px; position:absolute; width:530px;">
        
        </div>
        
    </div> 

    
<script> 
	$(function() {
		DV.toolbox("#toolbox"); // Панель кнопок
		DV.setup("notepad"); // Холст
		DV.readOnly = false; // Режим редактор / просмотр
		//DV.loadPupils('data/pupils.xml');
		/*DV.loadPupils("<pupils>"+
	    "   <pupil id='1' name='Нурсултан Тюякпай' user='arsik' gender='male'/>" +
		"	<pupil id='2' name='Дарига Кабылова' user='aige_rim' gender='female'/>"+
    	"</pupils>");*/
		
		DV.init('data/room-definition1.xml'); // Загружаем файл
		/*DV.initFromXMLString("<room-definition id='1' name='room1' title='Кабинет Билологии 22' grid='0' width='460' height='580'>"+
	    "    <desk id='2' title='Парта 1' x='40' y='200' width='100' height='40'/>"+
    	"</room-definition>"); */
	});
</script>
<script> 
	function toogleEditorMode(){
		DV.readOnly = !DV.readOnly;
		if(DV.readOnly){
			$("#toolbox, #navbar, #pupilsToolbox").fadeOut('slow');
			$("#notepad").addClass("readonly");
		} else {
			$("#toolbox, #navbar, #pupilsToolbox").fadeIn('slow');
			$("#notepad").removeClass("readonly");
		}
	}
</script> 


<!-- DV API -->
<script> 
	DV.onPupilClick = function(id,pupilNode){
		alert(id);
		console.log(pupilNode); // <pupil id="13" name="Лейла Храпун" user="muratbeydilov" gender="male"/>
	}
	
	DV.toolDeploy = function(){ // функция вызывается при нажатии кнопки сохранить
	  console.log(DV.roomDefinition); // свойство DV.roomDefinition хранит в себе весь xml дерево
	}
</script>
</body>
</html>

